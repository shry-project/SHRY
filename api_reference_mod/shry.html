
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>shry package &#8212; SHRY v0.1</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=e1a75a79"></script>
    <script src="../_static/doctools.js?v=fd6eb6e6"></script>
    <script src="../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'api_reference_mod/shry';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="How to cite SHRY" href="../citation.html" />
    <link rel="prev" title="API reference for modules" href="modules.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">SHRY v0.1</p>
  
</a></div>
        <div class="sidebar-primary-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/shry-project/SHRY" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notes/technical_notes.html">Technical Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api_reference_cli.html">API reference for command line tools</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="modules.html">API reference for modules</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">shry package</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../citation.html">How to cite SHRY</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Change Log</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/api_reference_mod/shry.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>shry package</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#submodules">Submodules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-shry.cif_io">shry.cif_io module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#shry.cif_io.parse_cif_string_to_structure"><code class="docutils literal notranslate"><span class="pre">parse_cif_string_to_structure()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#shry.cif_io.parse_cif_to_structure"><code class="docutils literal notranslate"><span class="pre">parse_cif_to_structure()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-shry.const">shry.const module</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-shry.core">shry.core module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#shry.core.NeedSupercellError"><code class="docutils literal notranslate"><span class="pre">NeedSupercellError</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#shry.core.Substitutor"><code class="docutils literal notranslate"><span class="pre">Substitutor</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shry.core.Substitutor.ase_atoms_writers"><code class="docutils literal notranslate"><span class="pre">Substitutor.ase_atoms_writers()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shry.core.Substitutor.cifwriters"><code class="docutils literal notranslate"><span class="pre">Substitutor.cifwriters()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shry.core.Substitutor.count"><code class="docutils literal notranslate"><span class="pre">Substitutor.count()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shry.core.Substitutor.disorder_groups"><code class="docutils literal notranslate"><span class="pre">Substitutor.disorder_groups</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shry.core.Substitutor.ewalds"><code class="docutils literal notranslate"><span class="pre">Substitutor.ewalds()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shry.core.Substitutor.groupby"><code class="docutils literal notranslate"><span class="pre">Substitutor.groupby</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shry.core.Substitutor.letters"><code class="docutils literal notranslate"><span class="pre">Substitutor.letters()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shry.core.Substitutor.make_patterns"><code class="docutils literal notranslate"><span class="pre">Substitutor.make_patterns()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shry.core.Substitutor.ordinalize"><code class="docutils literal notranslate"><span class="pre">Substitutor.ordinalize()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shry.core.Substitutor.pattern_makers"><code class="docutils literal notranslate"><span class="pre">Substitutor.pattern_makers</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shry.core.Substitutor.quantities"><code class="docutils literal notranslate"><span class="pre">Substitutor.quantities()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shry.core.Substitutor.structure"><code class="docutils literal notranslate"><span class="pre">Substitutor.structure</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shry.core.Substitutor.structure_writers"><code class="docutils literal notranslate"><span class="pre">Substitutor.structure_writers()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shry.core.Substitutor.total_count"><code class="docutils literal notranslate"><span class="pre">Substitutor.total_count()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shry.core.Substitutor.weights"><code class="docutils literal notranslate"><span class="pre">Substitutor.weights()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#shry.core.TooBigError"><code class="docutils literal notranslate"><span class="pre">TooBigError</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-shry.main">shry.main module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#shry.main.LabeledStructure"><code class="docutils literal notranslate"><span class="pre">LabeledStructure</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shry.main.LabeledStructure.copy"><code class="docutils literal notranslate"><span class="pre">LabeledStructure.copy()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shry.main.LabeledStructure.from_file"><code class="docutils literal notranslate"><span class="pre">LabeledStructure.from_file()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shry.main.LabeledStructure.read_label"><code class="docutils literal notranslate"><span class="pre">LabeledStructure.read_label()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shry.main.LabeledStructure.replace_species"><code class="docutils literal notranslate"><span class="pre">LabeledStructure.replace_species()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-shry.patches">shry.patches module</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-shry.script">shry.script module</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-shry">Module contents</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="shry-package">
<h1>shry package<a class="headerlink" href="#shry-package" title="Link to this heading">#</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading">#</a></h2>
</section>
<section id="module-shry.cif_io">
<span id="shry-cif-io-module"></span><h2>shry.cif_io module<a class="headerlink" href="#module-shry.cif_io" title="Link to this heading">#</a></h2>
<p>CIF I/O using PyCifRW instead of pymatgen.io.cif
Supports magnetic CIF files for future development.</p>
<dl class="py function">
<dt class="sig sig-object py" id="shry.cif_io.parse_cif_string_to_structure">
<span class="sig-prename descclassname"><span class="pre">shry.cif_io.</span></span><span class="sig-name descname"><span class="pre">parse_cif_string_to_structure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cif_text</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">primitive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">merge_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_oxidation_states</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shry.cif_io.parse_cif_string_to_structure" title="Link to this definition">#</a></dt>
<dd><p>Parse a CIF string using PyCifRW and convert to pymatgen Structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cif_text</strong> (<em>str</em>) – CIF contents as a string</p></li>
<li><p><strong>primitive</strong> (<em>bool</em>) – Whether to convert to primitive cell</p></li>
<li><p><strong>sort</strong> (<em>bool</em>) – Whether to sort sites</p></li>
<li><p><strong>merge_tol</strong> (<em>float</em>) – Tolerance for merging sites</p></li>
<li><p><strong>keep_oxidation_states</strong> (<em>bool</em>) – Whether to keep oxidation states when present</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>pymatgen.Structure object</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Structure</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shry.cif_io.parse_cif_to_structure">
<span class="sig-prename descclassname"><span class="pre">shry.cif_io.</span></span><span class="sig-name descname"><span class="pre">parse_cif_to_structure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cif_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">primitive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">merge_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_oxidation_states</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shry.cif_io.parse_cif_to_structure" title="Link to this definition">#</a></dt>
<dd><p>Parse a CIF file using PyCifRW and convert to pymatgen Structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cif_path</strong> (<em>str</em>) – Path to CIF file</p></li>
<li><p><strong>primitive</strong> (<em>bool</em>) – Whether to convert to primitive cell</p></li>
<li><p><strong>sort</strong> (<em>bool</em>) – Whether to sort sites</p></li>
<li><p><strong>merge_tol</strong> (<em>float</em>) – Tolerance for merging sites</p></li>
<li><p><strong>keep_oxidation_states</strong> (<em>bool</em>) – Whether to keep oxidation states when present</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>pymatgen.Structure object</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Structure</em></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-shry.const">
<span id="shry-const-module"></span><h2>shry.const module<a class="headerlink" href="#module-shry.const" title="Link to this heading">#</a></h2>
<p>Shared constants</p>
</section>
<section id="module-shry.core">
<span id="shry-core-module"></span><h2>shry.core module<a class="headerlink" href="#module-shry.core" title="Link to this heading">#</a></h2>
<p>Core operations, pattern generation, etc.</p>
<dl class="py exception">
<dt class="sig sig-object py" id="shry.core.NeedSupercellError">
<span class="property"><span class="k"><span class="pre">exception</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">shry.core.</span></span><span class="sig-name descname"><span class="pre">NeedSupercellError</span></span><a class="headerlink" href="#shry.core.NeedSupercellError" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Just so that this error will raise a distinguishable exception</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="shry.core.Substitutor">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">shry.core.</span></span><span class="sig-name descname"><span class="pre">Substitutor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symprec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle_tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groupby</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1770944942</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_dmat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sum'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shry.core.Substitutor" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Enumerate symmetrically unique ordered structures from a disordered structure.</p>
<p>Since the PatternMaker instances are saved,
it is advantageous to reuse the same Substitutor
for symmetrically similar structures.</p>
<p>This includes different subsitute concentrations
from the same basic structure, among others.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>disorder_groups</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>) – Mapping of grouping key (orbit identifier) to
tuples of disordered <code class="docutils literal notranslate"><span class="pre">PeriodicSite</span></code> objects that are substituted
together.</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>structure</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">pymatgen.core.Structure</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">shry.LabeledStructure</span></code>) – Input structure. Both plain pymatgen Structure and SHRY LabeledStructure
instances are supported.</p></li>
<li><p><strong>symprec</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Symmetry precision.</p></li>
<li><p><strong>angle_tolerance</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Angle tolerance for symmetry search.</p></li>
<li><p><strong>atol</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Absolute tolerance used in internal floating-point comparisons.</p></li>
<li><p><strong>groupby</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">function</span></code>) – <p>Function to group disordered sites.
Defaults to lambda x: x.properties[“_atom_site_label”], with the x loops
over all PeriodicSites within the Structure.</p>
<p>The proper function depends on what you want; do you want all sites of
a certain species or crystallographic orbit to be subsituted together?</p>
<p>Fallback to crystallographic orbit when failed.</p>
</p></li>
<li><p><strong>shuffle</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – If True, randomize branch traversal order during pattern search.</p></li>
<li><p><strong>seed</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Random seed used when <code class="docutils literal notranslate"><span class="pre">shuffle=True</span></code>.</p></li>
<li><p><strong>no_dmat</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether or not to use distance matrix as
permutation invariant (faster, default=True)</p></li>
<li><p><strong>t_kind</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Invariant mode used by PatternMaker (e.g. <code class="docutils literal notranslate"><span class="pre">sum</span></code>, <code class="docutils literal notranslate"><span class="pre">plsum</span></code>, <code class="docutils literal notranslate"><span class="pre">det</span></code>).</p></li>
<li><p><strong>cache</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code> or <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>) – By default(=None), cache patterns when involving either
multiple orbits or multiple species, but otherwise don’t.
Caching allows “reuse” of previously generated patterns,
at the cost of memory.
Set to False if memory is limited,
but note that pattern generation will be much slower.</p></li>
<li><p><strong>n_jobs</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Number of worker processes for pattern search.
<code class="docutils literal notranslate"><span class="pre">1</span></code> (default) disables process-based parallel search and is the
safest option for script usage on spawn-based platforms.
<code class="docutils literal notranslate"><span class="pre">-1</span></code> uses all available CPU cores.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="shry.core.Substitutor.ase_atoms_writers">
<span class="sig-name descname"><span class="pre">ase_atoms_writers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">symprec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shry.core.Substitutor.ase_atoms_writers" title="Link to this definition">#</a></dt>
<dd><p>Generate ASE Atoms objects for all unique patterns.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>symprec</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span> <span class="pre">|</span> <span class="pre">None</span></code>) – Unused. Kept for API compatibility.</p>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ase.Atoms</span></code> – ASE representation of each ordered configuration.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shry.core.Substitutor.cifwriters">
<span class="sig-name descname"><span class="pre">cifwriters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">symprec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shry.core.Substitutor.cifwriters" title="Link to this definition">#</a></dt>
<dd><p>Generate CIF writers (or magCIF string writers in MSG mode).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>symprec</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span> <span class="pre">|</span> <span class="pre">None</span></code>) – Optional symmetry precision used when building
symmetry-reduced CIF blocks.</p>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">CifWriter</span> <span class="pre">|</span> <span class="pre">_StringWriter</span></code> – Writer object for each configuration.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shry.core.Substitutor.count">
<span class="sig-name descname"><span class="pre">count</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#shry.core.Substitutor.count" title="Link to this definition">#</a></dt>
<dd><p>Return the number of symmetry-inequivalent substitution patterns.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Number of unique patterns after symmetry reduction.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="shry.core.Substitutor.disorder_groups">
<span class="sig-name descname"><span class="pre">disorder_groups</span></span><a class="headerlink" href="#shry.core.Substitutor.disorder_groups" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shry.core.Substitutor.ewalds">
<span class="sig-name descname"><span class="pre">ewalds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">symprec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shry.core.Substitutor.ewalds" title="Link to this definition">#</a></dt>
<dd><p>Generate Ewald energies for all unique patterns.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>symprec</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span> <span class="pre">|</span> <span class="pre">None</span></code>) – Optional symmetry precision forwarded to CIF generation.</p>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code> – Ewald total energy for each configuration.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="shry.core.Substitutor.groupby">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">groupby</span></span><a class="headerlink" href="#shry.core.Substitutor.groupby" title="Link to this definition">#</a></dt>
<dd><p>Grouping function used to partition disorder sites into substitution orbits.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Function that maps each PeriodicSite to a grouping key.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Callable</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shry.core.Substitutor.letters">
<span class="sig-name descname"><span class="pre">letters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#shry.core.Substitutor.letters" title="Link to this definition">#</a></dt>
<dd><p>Generate letter-encoded substitution patterns.</p>
<dl class="field-list simple">
<dt class="field-odd">Yields<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code> – Compact letter string representing one substitution pattern.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shry.core.Substitutor.make_patterns">
<span class="sig-name descname"><span class="pre">make_patterns</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#shry.core.Substitutor.make_patterns" title="Link to this definition">#</a></dt>
<dd><p>Generate raw substitution patterns for all disordered sites.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Pairs of <code class="docutils literal notranslate"><span class="pre">(aut,</span> <span class="pre">pattern)</span></code> where <code class="docutils literal notranslate"><span class="pre">aut</span></code> is the automorphism index
array and <code class="docutils literal notranslate"><span class="pre">pattern</span></code> is the orbit-wise substitution index pattern.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Iterator[tuple[np.ndarray, list[np.ndarray]]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shry.core.Substitutor.ordinalize">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">ordinalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shry.core.Substitutor.ordinalize" title="Link to this definition">#</a></dt>
<dd><p>Ordinalize array elements to the specified absolute tolerance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.array</span></code>) – The array to be ordinalized.</p></li>
<li><p><strong>atol</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Absolute tolerance. Defaults to 1e-5.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The ordinalized array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="shry.core.Substitutor.pattern_makers">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">pattern_makers</span></span><a class="headerlink" href="#shry.core.Substitutor.pattern_makers" title="Link to this definition">#</a></dt>
<dd><p>Access cached PatternMaker instances.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Mapping from PatternMaker label to PatternMaker instance.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shry.core.Substitutor.quantities">
<span class="sig-name descname"><span class="pre">quantities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symprec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shry.core.Substitutor.quantities" title="Link to this definition">#</a></dt>
<dd><p>Generate selected quantities for each symmetry-inequivalent configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list[str]</span></code>) – Keys to include in each yielded packet.
Valid keys are <code class="docutils literal notranslate"><span class="pre">&quot;cifwriter&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;weight&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;letter&quot;</span></code>,
<code class="docutils literal notranslate"><span class="pre">&quot;ewald&quot;</span></code>, and <code class="docutils literal notranslate"><span class="pre">&quot;structure&quot;</span></code>.</p></li>
<li><p><strong>symprec</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span> <span class="pre">|</span> <span class="pre">None</span></code>) – Optional symmetry precision used for CIF/Ewald
generation in helper methods.</p></li>
</ul>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code> – Dictionary containing requested quantities for one configuration.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="shry.core.Substitutor.structure">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">structure</span></span><a class="headerlink" href="#shry.core.Substitutor.structure" title="Link to this definition">#</a></dt>
<dd><p>Input structure currently held by this Substitutor.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Internal working copy of the input structure.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pymatgen.core.Structure</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shry.core.Substitutor.structure_writers">
<span class="sig-name descname"><span class="pre">structure_writers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">symprec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shry.core.Substitutor.structure_writers" title="Link to this definition">#</a></dt>
<dd><p>Generate ordered pymatgen structures for all unique patterns.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>symprec</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span> <span class="pre">|</span> <span class="pre">None</span></code>) – Unused. Kept for API compatibility with other
writer generators.</p>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">pymatgen.core.Structure</span></code> – Ordered structure for each configuration.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shry.core.Substitutor.total_count">
<span class="sig-name descname"><span class="pre">total_count</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#shry.core.Substitutor.total_count" title="Link to this definition">#</a></dt>
<dd><p>Return the total number of combinatorial substitutions (without symmetry reduction).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Total number of possible substitutions.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shry.core.Substitutor.weights">
<span class="sig-name descname"><span class="pre">weights</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#shry.core.Substitutor.weights" title="Link to this definition">#</a></dt>
<dd><p>Generate symmetry weights for all unique patterns.</p>
<dl class="field-list simple">
<dt class="field-odd">Yields<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code> – Weight of one pattern (group-size divided by automorphism size).</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="shry.core.TooBigError">
<span class="property"><span class="k"><span class="pre">exception</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">shry.core.</span></span><span class="sig-name descname"><span class="pre">TooBigError</span></span><a class="headerlink" href="#shry.core.TooBigError" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>When the number of substitution is too large</p>
</dd></dl>

</section>
<section id="module-shry.main">
<span id="shry-main-module"></span><h2>shry.main module<a class="headerlink" href="#module-shry.main" title="Link to this heading">#</a></h2>
<p>Main task abstraction</p>
<dl class="py class">
<dt class="sig sig-object py" id="shry.main.LabeledStructure">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">shry.main.</span></span><span class="sig-name descname"><span class="pre">LabeledStructure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lattice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">species</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">charge</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validate_proximity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_unit_cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords_are_cartesian</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">site_properties</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">properties</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shry.main.LabeledStructure" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Structure</span></code></p>
<p>Structure subclass that preserves CIF label and magnetic-moment metadata.</p>
<p>In addition to standard <code class="docutils literal notranslate"><span class="pre">pymatgen.Structure</span></code> behavior, this class stores
per-site CIF-derived properties such as <code class="docutils literal notranslate"><span class="pre">_atom_site_label</span></code> and magnetic
moment mappings. These properties are kept consistent across common
structure operations (copy, supercell expansion, species replacement), so
downstream SHRY substitution logic can track site identity robustly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lattice</strong> (<em>ArrayLike</em><em> | </em><em>Lattice</em>)</p></li>
<li><p><strong>species</strong> (<em>Sequence</em><em>[</em><em>CompositionLike</em><em>]</em>)</p></li>
<li><p><strong>coords</strong> (<em>Sequence</em><em>[</em><em>ArrayLike</em><em>] </em><em>| </em><em>ArrayLike</em>)</p></li>
<li><p><strong>charge</strong> (<em>float</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>validate_proximity</strong> (<em>bool</em>)</p></li>
<li><p><strong>to_unit_cell</strong> (<em>bool</em>)</p></li>
<li><p><strong>coords_are_cartesian</strong> (<em>bool</em>)</p></li>
<li><p><strong>site_properties</strong> (<em>dict</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>labels</strong> (<em>Sequence</em><em>[</em><em>str</em><em> | </em><em>None</em><em>] </em><em>| </em><em>None</em>)</p></li>
<li><p><strong>properties</strong> (<em>dict</em><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="shry.main.LabeledStructure.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shry.main.LabeledStructure.copy" title="Link to this definition">#</a></dt>
<dd><p>Return a deep copy preserving the <code class="docutils literal notranslate"><span class="pre">LabeledStructure</span></code> type.</p>
<p>pymatgen’s Structure.copy() returns a Structure instance; SHRY relies on
LabeledStructure methods (e.g. replace_species) to keep CIF labels and
magnetic moments consistent after modifications.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>Copied instance with duplicated site and structure</dt><dd><p>properties.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#shry.main.LabeledStructure" title="shry.main.LabeledStructure">LabeledStructure</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shry.main.LabeledStructure.from_file">
<span class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">primitive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">merge_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symmetrize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shry.main.LabeledStructure.from_file" title="Link to this definition">#</a></dt>
<dd><p>Create a <code class="docutils literal notranslate"><span class="pre">LabeledStructure</span></code> from CIF/magCIF and attach labels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Path to <code class="docutils literal notranslate"><span class="pre">.cif</span></code> or <code class="docutils literal notranslate"><span class="pre">.mcif</span></code> file.</p></li>
<li><p><strong>primitive</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to return a primitive structure.</p></li>
<li><p><strong>sort</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to sort sites during parsing.</p></li>
<li><p><strong>merge_tol</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Site merge tolerance used by parser.</p></li>
<li><p><strong>symmetrize</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – If True, match labels using spglib symmetry
operations instead of CIF symmetry operators.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Parsed structure populated with</dt><dd><p><code class="docutils literal notranslate"><span class="pre">_atom_site_label</span></code> and related properties.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#shry.main.LabeledStructure" title="shry.main.LabeledStructure">LabeledStructure</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If file extension is not CIF/magCIF.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shry.main.LabeledStructure.read_label">
<span class="sig-name descname"><span class="pre">read_label</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cif_filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symprec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle_tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symmetrize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shry.main.LabeledStructure.read_label" title="Link to this definition">#</a></dt>
<dd><p>Read CIF/magCIF labels and map them onto current structure sites.</p>
<p>Adds <code class="docutils literal notranslate"><span class="pre">_atom_site_label</span></code> and associated magnetic/occupancy properties to
each site. For magCIF input, magnetic moments are transformed according to
magnetic symmetry operations when required.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cif_filename</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Source CIF file.</p></li>
<li><p><strong>symprec</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Symmetry precision used when <code class="docutils literal notranslate"><span class="pre">symmetrize=True</span></code>.</p></li>
<li><p><strong>angle_tolerance</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Angle tolerance for symmetry operations.</p></li>
<li><p><strong>symmetrize</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – If True, use spglib-derived symmetry operations for
label matching.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> – If any structure site cannot be matched to CIF-defined
    positions/labels.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shry.main.LabeledStructure.replace_species">
<span class="sig-name descname"><span class="pre">replace_species</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">species_mapping</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shry.main.LabeledStructure.replace_species" title="Link to this definition">#</a></dt>
<dd><p>Replace species/labels while preserving CIF and magnetic metadata.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>species_mapping</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">dict[str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str]</span></code>) – Mapping from source label/element to
target species expression. Keys are first matched against
<code class="docutils literal notranslate"><span class="pre">_atom_site_label</span></code> entries; if not found, element-symbol matches
are attempted.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> – If no sites match at least one source key in
    specification.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-shry.patches">
<span id="shry-patches-module"></span><h2>shry.patches module<a class="headerlink" href="#module-shry.patches" title="Link to this heading">#</a></h2>
<p>Runtime patches for pymatgen classes.</p>
</section>
<section id="module-shry.script">
<span id="shry-script-module"></span><h2>shry.script module<a class="headerlink" href="#module-shry.script" title="Link to this heading">#</a></h2>
<p>Command line interface.</p>
</section>
<section id="module-shry">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-shry" title="Link to this heading">#</a></h2>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="modules.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">API reference for modules</p>
      </div>
    </a>
    <a class="right-next"
       href="../citation.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">How to cite SHRY</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#submodules">Submodules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-shry.cif_io">shry.cif_io module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#shry.cif_io.parse_cif_string_to_structure"><code class="docutils literal notranslate"><span class="pre">parse_cif_string_to_structure()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#shry.cif_io.parse_cif_to_structure"><code class="docutils literal notranslate"><span class="pre">parse_cif_to_structure()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-shry.const">shry.const module</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-shry.core">shry.core module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#shry.core.NeedSupercellError"><code class="docutils literal notranslate"><span class="pre">NeedSupercellError</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#shry.core.Substitutor"><code class="docutils literal notranslate"><span class="pre">Substitutor</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shry.core.Substitutor.ase_atoms_writers"><code class="docutils literal notranslate"><span class="pre">Substitutor.ase_atoms_writers()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shry.core.Substitutor.cifwriters"><code class="docutils literal notranslate"><span class="pre">Substitutor.cifwriters()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shry.core.Substitutor.count"><code class="docutils literal notranslate"><span class="pre">Substitutor.count()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shry.core.Substitutor.disorder_groups"><code class="docutils literal notranslate"><span class="pre">Substitutor.disorder_groups</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shry.core.Substitutor.ewalds"><code class="docutils literal notranslate"><span class="pre">Substitutor.ewalds()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shry.core.Substitutor.groupby"><code class="docutils literal notranslate"><span class="pre">Substitutor.groupby</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shry.core.Substitutor.letters"><code class="docutils literal notranslate"><span class="pre">Substitutor.letters()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shry.core.Substitutor.make_patterns"><code class="docutils literal notranslate"><span class="pre">Substitutor.make_patterns()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shry.core.Substitutor.ordinalize"><code class="docutils literal notranslate"><span class="pre">Substitutor.ordinalize()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shry.core.Substitutor.pattern_makers"><code class="docutils literal notranslate"><span class="pre">Substitutor.pattern_makers</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shry.core.Substitutor.quantities"><code class="docutils literal notranslate"><span class="pre">Substitutor.quantities()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shry.core.Substitutor.structure"><code class="docutils literal notranslate"><span class="pre">Substitutor.structure</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shry.core.Substitutor.structure_writers"><code class="docutils literal notranslate"><span class="pre">Substitutor.structure_writers()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shry.core.Substitutor.total_count"><code class="docutils literal notranslate"><span class="pre">Substitutor.total_count()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shry.core.Substitutor.weights"><code class="docutils literal notranslate"><span class="pre">Substitutor.weights()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#shry.core.TooBigError"><code class="docutils literal notranslate"><span class="pre">TooBigError</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-shry.main">shry.main module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#shry.main.LabeledStructure"><code class="docutils literal notranslate"><span class="pre">LabeledStructure</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shry.main.LabeledStructure.copy"><code class="docutils literal notranslate"><span class="pre">LabeledStructure.copy()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shry.main.LabeledStructure.from_file"><code class="docutils literal notranslate"><span class="pre">LabeledStructure.from_file()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shry.main.LabeledStructure.read_label"><code class="docutils literal notranslate"><span class="pre">LabeledStructure.read_label()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shry.main.LabeledStructure.replace_species"><code class="docutils literal notranslate"><span class="pre">LabeledStructure.replace_species()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-shry.patches">shry.patches module</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-shry.script">shry.script module</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-shry">Module contents</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Kosuke Nakano, Genki Imam Prayogo
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2026, Kosuke Nakano, Genki Imam Prayogo.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>